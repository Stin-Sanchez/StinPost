<html th:replace="~{fragments/layout :: plantilla(~{::body})}" xmlns:th="http://www.thymeleaf.org">
<body>
<div th:fragment="content">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Gestión de Ventas</h2>
        <a class="btn btn-primary" th:href="@{/sales/formSales}">
            <i class="bi bi-plus-circle-fill"></i> Nueva Venta
        </a>
    </div>

    <div class="row g-3 mb-4">
        <div class="col-md-8">
            <div class="input-group">
                <span class="input-group-text bg-white text-muted">
                    <i class="bi bi-search"></i>
                </span>
                <input class="form-control border-start-0 ps-0"
                       id="inputSearch"
                       placeholder="Buscar por nombre de cliente o factura"
                       type="text">
            </div>
        </div>

        <div class="col-md-4">
            <div class="input-group">
                <label class="input-group-text bg-light" for="inputFilter">
                    <i class="bi bi-funnel-fill me-2"></i> Filtrar
                </label>
                <select class="form-select" id="inputFilter">
                    <option selected value="ALL">Todas</option>

                    <option th:each="estado:${estados}"
                            th:text="${estado.description}"
                            th:value="${estado}">
                    </option>

                </select>
            </div>
        </div>
    </div>

    <div id="alertContainer"></div>

    <div class="card shadow-sm">
        <div class="card-body p-0 table-responsive">
            <table class="table table-striped table-hover align-middle mb-0">
                <thead class="table-light">
                <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Cliente</th>
                    <th scope="col">Monto</th>
                    <th scope="col">Fecha</th>
                    <th scope="col">Método de pago</th>
                    <th scope="col">Vendedor</th>
                    <th scope="col">NO.Factura</th>
                    <th scope="col">Estado</th>
                    <th scope="col">Acciones</th>
                </tr>
                </thead>
                <tbody id="salesTableBody">
                </tbody>
            </table>
        </div>
    </div>

    <div aria-hidden="true" class="modal fade" id="modalDetalleVenta" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">
                        <i class="bi bi-receipt me-2"></i>Detalle de Venta #<span id="modalVentaId"></span>
                    </h5>
                    <button aria-label="Close" class="btn-close btn-close-white" data-bs-dismiss="modal"
                            type="button"></button>
                </div>

                <div class="modal-body">
                    <div class="row mb-4 p-3 bg-light rounded border mx-1">
                        <div class="col-md-6">
                            <p class="mb-1"><strong>Cliente:</strong> <span id="modalCliente"></span></p>
                            <p class="mb-1"><strong>Vendedor:</strong> <span id="modalVendedor"></span></p>
                            <p class="mb-0"><strong>Factura:</strong> <span class="font-monospace"
                                                                            id="modalFactura"></span></p>
                        </div>
                        <div class="col-md-6 text-end">
                            <p class="mb-1"><strong>Fecha:</strong> <span id="modalFecha"></span></p>
                            <p class="mb-1"><strong>Método Pago:</strong> <span id="modalPago"></span></p>
                            <p class="mb-0"><strong>Estado:</strong> <span id="modalEstado"></span></p>
                        </div>
                    </div>

                    <h6 class="border-bottom pb-2 mb-3">Productos Adquiridos</h6>
                    <div class="table-responsive">
                        <table class="table table-sm table-bordered align-middle">
                            <thead class="table-light">
                            <tr>
                                <th>Producto</th>
                                <th class="text-center">Cant.</th>
                                <th class="text-end">Precio Unit.</th>
                                <th class="text-end">Subtotal</th>
                            </tr>
                            </thead>
                            <tbody id="modalTablaProductos">
                            </tbody>
                            <tfoot class="table-light">
                            <tr>
                                <td class="text-end fw-bold" colspan="3">TOTAL:</td>
                                <td class="text-end fw-bold fs-5 text-primary" id="modalTotal"></td>
                            </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Cerrar</button>
                    <button class="btn btn-outline-primary" onclick="window.print()" type="button">
                        <i class="bi bi-printer"></i> Imprimir
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script th:src="@{/js/sales.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</div>
</body>
</html>